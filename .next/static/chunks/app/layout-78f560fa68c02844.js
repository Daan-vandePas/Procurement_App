(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{1310:function(e,s,t){Promise.resolve().then(t.t.bind(t,7960,23)),Promise.resolve().then(t.bind(t,5860))},5860:function(e,s,t){"use strict";t.d(s,{default:function(){return c}});var a=t(7437),r=t(2265),n=t(9376),l=t(7648);function c(e){let{children:s}=e,[t,c]=(0,r.useState)(null),[u,i]=(0,r.useState)(!0),o=(0,n.useRouter)(),m=(0,n.usePathname)(),d=["/login"].includes(m);(0,r.useEffect)(()=>{h()},[]);let h=async()=>{try{let e=await fetch("/api/auth/me");if(e.ok){let s=await e.json();if(c(s),"/login"===m){o.push(x(s.role));return}}else if(c(null),!d){o.push("/login?redirect=".concat(encodeURIComponent(m)));return}}catch(e){if(c(null),!d){o.push("/login");return}}i(!1)},x=e=>{switch(e){case"ceo":case"purchaser":return"/requests";default:return"/"}},f=async()=>{try{await fetch("/api/auth/logout",{method:"POST"}),c(null),o.push("/login?message=logged-out")}catch(e){}};return u&&!d?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading..."})]})}):d||!t?(0,a.jsx)("div",{className:"min-h-screen bg-gray-50",children:s}):(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white shadow-sm border-b",children:(0,a.jsx)("div",{className:"max-w-4xl mx-auto px-4 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(l.default,{href:x(t.role),className:"text-2xl font-semibold text-gray-900 hover:text-gray-700",children:"Procurement System"}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("nav",{className:"flex space-x-4",children:(t?[{href:"/requests",label:"All Requests"}]:[]).map(e=>(0,a.jsx)(l.default,{href:e.href,className:"px-3 py-2 text-sm font-medium ".concat(m===e.href?"text-blue-600 bg-blue-50 rounded-md":"text-gray-600 hover:text-gray-900"),children:e.label},e.href))}),(0,a.jsxs)("div",{className:"flex items-center space-x-3 border-l pl-4",children:[(0,a.jsxs)("div",{className:"text-sm",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:t.name}),(0,a.jsx)("p",{className:"text-gray-500 capitalize",children:t.role})]}),(0,a.jsx)("button",{onClick:f,className:"text-sm text-gray-600 hover:text-gray-900 font-medium",children:"Logout"})]})]})]})})}),(0,a.jsx)("main",{className:"max-w-4xl mx-auto px-4 py-8",children:s})]})}},9376:function(e,s,t){"use strict";var a=t(5475);t.o(a,"useParams")&&t.d(s,{useParams:function(){return a.useParams}}),t.o(a,"usePathname")&&t.d(s,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(s,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(s,{useSearchParams:function(){return a.useSearchParams}})},7960:function(){}},function(e){e.O(0,[587,648,971,117,744],function(){return e(e.s=1310)}),_N_E=e.O()}]);